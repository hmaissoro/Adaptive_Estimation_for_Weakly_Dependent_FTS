% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/02_smoothing.R
\name{estimate_nw_bw}
\alias{estimate_nw_bw}
\title{Nadaraya-Watson Bandwidth Selection using cross validation.}
\usage{
estimate_nw_bw(y, t, bw_grid = NULL, smooth_ker = epanechnikov)
}
\arguments{
\item{y}{\code{vector (numeric)}. A numeric vector containing the observed values of the independent variable corresponding to the observation points \code{t}.}

\item{t}{\code{vector (numeric)}. A numeric vector containing the observed values of the dependent variable.}

\item{bw_grid}{\code{vector (numeric)}. A grid of bandwidth to test. Default \code{bw_grid = NULL}, so it will be set as an exponential grid of \code{length(t)}.}

\item{smooth_ker}{\code{function}. The kernel function of the estimator.}
}
\value{
A \code{numeric} value corresponding to the best bandwidth.
}
\description{
Nadaraya-Watson Bandwidth Selection using cross validation.
}
\examples{
\dontrun{
# The model
## Let
m <- function(t) 4 * sin(1.5 * pi * t)

## Observation points
t <- runif(n = 200, min = 0, max = 1)
t <- sort(t)

## Measure error
e <- rnorm(n = 200, mean = 0, sd = 0.2)

## Regression model
y <- m(t) + e

plot(x = t, y = y, main = "Observed points and true regression function")
lines(x = t, y = m(t), type = "l", col = "red")

## Estimate the best bandwidth
bw_grid <- seq(1 / (2 * length(t)), length(t) ** (- 1/3), len = 100)
hbest <- estimate_nw_bw(y = y, t = t,
                        bw_grid = bw_grid,
                        smooth_ker = epanechnikov)

## Estimate the regression function
dt_nw <- estimate_nw(y = y, t = t,
                     tnew = seq(0.01, 0.99, len = 100),
                     h = hbest, smooth_ker = epanechnikov)

plot(x = dt_nw[, tnew], y = dt_nw[, yhat], type = "l", col = "blue",
     main = "Estimated and true regression function.")
lines(x = dt_nw[, tnew], y = m(dt_nw[, tnew]), type = "l", col = "red")
legend(x = 0.64, y = 4.1, fill = c("blue", "red"),legend = c("Estimated m", "True m"))

}

}
\seealso{
[estimate_nw()]
}
